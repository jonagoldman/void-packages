# Template file for 'visual-studio-code'
pkgname=visual-studio-code
version=1.57.0
revision=1
depends=""
wrksrc="VSCode-linux-x64"
short_desc="Visual Studio Code"
maintainer="jonagoldman <jonagoldman@gmail.com>"
license="MIT"
homepage="https://code.visualstudio.com"
distfiles="https://az764295.vo.msecnd.net/stable/b4c1bd0a9b03c749ea011b06c6d2676c8091a70c/code-stable-x64-1623259999.tar.gz"
checksum=417f5df3a6d510bfb2047182601c07dab7731ff2c2c7fc50b760662e272949ae
nopie=1

do_install() {
    # source
    vmkdir usr/lib/${pkgname}
    vcopy ${wrksrc}/* usr/lib/${pkgname}

    # binary
    vmkdir usr/bin
    ln -sf /usr/lib/${pkgname}/bin/code ${DESTDIR}/usr/bin/code

    # icon
    vmkdir usr/share/pixmaps
    ln -sf /usr/lib/${pkgname}/resources/app/resources/linux/code.png ${DESTDIR}/usr/share/pixmaps/code.png

    # license
    vlicense ${wrksrc}/resources/app/LICENSE.rtf

    # desktop
    vmkdir usr/share/applications
    vinstall ${FILESDIR}/${pkgname}.desktop 644 /usr/share/applications
    vinstall ${FILESDIR}/${pkgname}-url-handler.desktop 644 /usr/share/applications
    
    # mime
    vmkdir usr/share/mime/packages
    vinstall ${FILESDIR}/${pkgname}-workspace.xml 644 /usr/share/mime/packages
}
